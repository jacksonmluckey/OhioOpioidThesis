# Results

```{r regressionFormula}
regression_formula <- function(rate_variable, income_variable, fixed_effects=NULL) {
  
  # check that rate_variable is valid
  if(!rate_variable %in% c("`Fatal Overdose Crude Rate`",
                          "`Fatal Overdose Age-Adjusted Rate`",
                          "`Fatak Overdose Modeled Rate`")) {
    stop(rate_variable, " is not a valid fatal overdose rate variable. Did you forget to wrap it in ``s like `Fatal Overdose Crude Rate`?")
  }
  
  # check that income_variable is valid
  if(!income_variable %in% c("`Median Individual Income`",
                             "`Median Household Income`")) {
    stop(income_variable, " is not a valid income variable. Did you forget to wrap it in ``s like `Median Individual Income`?")
  }
  
  # excludes 1 from each category (currently 5 and under for both sexes, highschool or less for education)
  formula_base <- paste("`Percent of Males Aged Under 5 with a Disability`",
    "`Percent of Males Aged 5 to 17 with a Disability`",
    "`Percent of Males Aged 18 to 34 with a Disability`",
    "`Percent of Males Aged 35 to 64 with a Disability`",
    "`Percent of Males Aged 65 to 74 with a Disability`",
    "`Percent of Males Aged 75 and Up with a Disability`",
    "`Percent of Females Aged Under 5 with a Disability`",
    "`Percent of Females Aged 5 to 17 with a Disability`",
    "`Percent of Females Aged 18 to 34 with a Disability`",
    "`Percent of Females Aged 35 to 64 with a Disability`",
    "`Percent of Females Aged 65 to 74 with a Disability`",
    "`Percent of Females Aged 75 and Up with a Disability`",
    "`Percent Black`",
    "`Percent with Some College`",
    "`Percent with Bachelors or More`",
    sep = " + "
  )
  
  regression_formula <- as.formula(paste0(rate_variable, " ~ ", formula_base, " + ", income_variable))
  
  # return formula
  regression_formula
  
}
```

Fixed effects: https://www.econometrics-with-r.org/10-3-fixed-effects-regression.html

```{r crudeRateIndividualIncomeNoFixedEffects, results="asis"}
crude_rate_individual_noFE <- regression_formula("`Fatal Overdose Crude Rate`", "`Median Individual Income`")
stargazer(lm(crude_rate_individual_noFE, df_acs1),
          lm(crude_rate_individual_noFE, df_acs5),
          header = FALSE)
```

```{r crudeRateHouseholdIncomeNoFixedEffects, results="asis"}
crude_rate_household_noFE <- regression_formula("`Fatal Overdose Crude Rate`", "`Median Household Income`")
stargazer(lm(crude_rate_household_noFE, df_acs1),
          lm(crude_rate_household_noFE, df_acs5),
          header = FALSE)
```

## Ordinary Least Squares Multiple Regression

```{r prepareBasicOLS, eval=FALSE}
# deprecated?
basic_model <- lm(basic_regression_formula, df)

df_no_cle <- df %>%
  filter(county != "Cuyahoga")

basic_model_no_cle <- lm(basic_regression_formula, df_no_cle)
```

```{r stargazerOLS, results="asis", eval=FALSE}
# deprecated?
stargazer(basic_model, basic_model_no_cle,
          title = "OLS Multiple Regression With (1) and Without (2) Cuyahoga County",
          single.row = TRUE,
          header = FALSE)
```

The ordinary least squares multiple regression models in table 3.1 explain just under 30% of the variation in the fatal opioid overdose rate. Regardless of whether or not Cuyahoga county is included in the sample, the same four explanatory variables are statistically significant: individual income per capita, percent black, bachelors degree or more, and the percent of females between the ages 35 and 64 with a disability. As income increases, so do overdoses. This could be explained by increased capacity to purchase opioids, which can cost over $100 a day [@macyDopesickDealersDoctors2018; @meierPainKillerEmpire2018; @quinonesDreamlandTrueTale2016]. As the percentage of the county population that is black increases, opioid overdoses increase. This juxtaposes the literature, which suggested that opioid addiction is primarily a rural and suburban white phenomena. It is possible that the counties excluded from the sample are responsible for this effect. As the percentage of the adult population of a county that has a bachelors degree or higher rises, opioid overdoses fall. There are several possible explanations for this, including education providing job opportunities that prevent deaths of despair, education helping individuals make informed health decision, or education changing individual's social networks in a way that makes opioids harder to access. Finally, as the percentage of women between the ages 35 and 64 with a disability increases, opioid overdoses increase. While the literature stated that disabilities increase opioid use, it generally emphasized disabilities in men, especially in men with a blue-collar occupation.

Excluding Cuyahoga county from the samle increases the explanatory power of the model. The direction of the explanatory variable paramters stays the same, but the size and significance of the effect changes for some of the variables. Income does not change in any way. After excluding Cuyahoga county, opioid overdose deaths rise more in response to an unit increase in the percent of the county that is black. I expected the parameter estimate to decrease, rather than increase, given the literature, and am unsure of how to explain this effect. Both the protective effect of having a bachelors degree and the significance of that effect decrease when Cuyahoga county is excluded. Finally, the increase in overdose deaths as the percentage of women between the ages of 35 and 64 with a disability increases is less when Cuyahoga county is excluded. 

## Tobit Model

For the Tobit model, I used the minimum value of OD_rate across the entire dataset as my left limit for the censored variable as instructed to by Denise. According to Denise, if tobit coefficients are very similar to simple linear regression coefficients, then censoring is not a big issue [@hareThesisMeetings2019]. As shown in table 3.3, there does not appear to be a significant difference between the censored regression model estimate parameters and the ordinary least squares multiple regression model estimate parameters. Therefore, we can assume that censoring is not a significant issue with the current data. Table 3.2 shows that excluding Cuyahoga county has similar effects on both the tobit and OLS model.

```{r stargazerTobit, results = "asis", eval=FALSE}
# deprecated?
tobit_with_cle <- censReg(basic_regression_formula, left = 0.5066819, data = df, logLikOnly = FALSE)
tobit_without_cle <- censReg(basic_regression_formula, left = 0.5066819, data = df_no_cle, logLikOnly = FALSE)
stargazer(tobit_with_cle, tobit_without_cle,
          title = "Tobit Model With (1) and Without (2) Cuyahoga County",
          single.row = TRUE,
          header = FALSE)
```

```{r stargazerTobitOLS, results = "asis", eval=FALSE}
# deprecated?
stargazer(basic_model, tobit_with_cle,
          title = "OLS Multiple Regression (1) vs Tobit (2)",
          single.row = TRUE,
          header = FALSE)
```
