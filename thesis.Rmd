---
author: 'Jackson Maillie Luckey'
date: 'May 2020'
institution: 'Reed College'
division: 'History and Social Sciences'
advisor: 'Denise Hare'
department: 'Economics'
degree: 'Bachelor of Arts'
title: 'OhioOpioidThesis'
knit: "bookdown::render_book"
site: bookdown::bookdown_site
output: 
  thesisdown::thesis_pdf: default
#  thesisdown::thesis_gitbook: default
#  thesisdown::thesis_word: default
#  thesisdown::thesis_epub: default
# If you are creating a PDF you'll need to write your preliminary content (e.g., abstract, acknowledgements) here or
# use code similar to line 22-23 for the .RMD files. If you are NOT producing a PDF, you can delete or silence lines 21-32 in this YAML header.
#abstract: |
#  `r if(knitr:::is_latex_output()) paste(readLines("00-abstract.Rmd"), collapse = '\n  ')`
# If you'd rather include the preliminary content in files instead of inline
# like below, use a command like that for the abstract above.  Note that a tab is 
# needed on the line after the `|`.
#acknowledgements: |
#  I want to thank a few people.
#dedication: |
#  You can have a dedication here if you wish. 
#preface: |
#  This is an example of a thesis setup to use the reed thesis document class
#(for LaTeX) and the R bookdown package, in general.
# Specify the location of the bibliography below
bibliography: bib/thesis.bib
# Download your specific csl file and refer to it in the line below.
csl: csl/apa.csl
lot: true
lof: true
# If you prefer blank lines between paragraphs, un-silence lines  40-41 (this requires package tikz)
#header-includes:
#- \usepackage{tikz}
---
  
  <!--
  Above is the YAML (YAML Ain't Markup Language) header that includes a lot of metadata used to produce the document.  Be careful with spacing in this header!
If you'd prefer to not include a Dedication, for example, simply delete the section entirely, or silence (add #) them. 
                                                                                                          If you have other LaTeX packages you would like to include, delete the # before header-includes and list the packages after hyphens on new lines.
                                                                                                          If you'd like to include a comment that won't be produced in your resulting file enclose it in a block like this.
                                                                                                          If you receive a duplicate label error after knitting, make sure to delete the index.Rmd file and then knit again.
                                                                                                          -->
                                                                                                            
```{r include_packages, include = FALSE}
# This chunk ensures that the thesisdown package is
# installed and loaded. This thesisdown package includes
# the template files for the thesis.
if(!require(devtools))                                                                                                            install.packages("devtools", repos = "http://cran.rstudio.com")
if(!require(thesisdown))                                                                                                            devtools::install_github("ismayc/thesisdown")
library(thesisdown)
```
                                                                                                            
# Introduction {.unnumbered}
                                                                                                            

<!--chapter:end:index.Rmd-->

---
title: "Opioid Thesis: Literature Review Chapter"
author: "Jackson Luckey"
date: "12/6/2019"
output: pdf_document
font-size: 12pt
geometry: margin=1in
header-includes:
    - \usepackage{setspace}\doublespacing
bibliography: references.bib
---

```{r setup_chpt1, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(citr)
```

# Introduction

According to the Center for Disease Control, the opioid epidemic is the worst drug epidemic in US history. While opioids are a legitimate medical treatment for acute pain, they are highly addictive and come with the risk of abuse, dependence, and fatal overdose [@aliprantisOpioidsLaborMarket2018]. Abuse of and dependence on opioids has serious consequences. Since 2016, drug overdoses have been the leading cause of accidental death in the United States [@maguireOpioidCrisisAppalachia2019]. Overdoses kill more people than gun violence, motor vehicle incidents, or the HIV/AIDS epidemic did at its peak [@quinonesDreamlandTrueTale2016; @ciccaroneFentanylUSHeroin2017; @alpertSupplySideDrugPolicy2017]. In fact, the scourge of opioid overdoses is so severe that it has lead to an increase in all-cause mortality for white Americans despite mortality decreasing for all other Americans and citizens of comparably developed countries [@caseMortalityMorbidity21st2017]. Reducing the number of deaths due to opioids is essential to reversing this trend, increasing the labor supply, and improving outcomes for millions of Americans.

(will probably not be part of this chapter long-term)

# Rationality

## Definition of Rationality

While there is significant evidence that consumers are not "rational", the economics discipline is founded upon the theory of consumer rationality [@arcidiaconoConsumerRationalityMultidisciplinary2011]. Rational consumers make choices based on a set of consistent preferences that are complete[^1], reflexive[^2], and transitive[^3] [@blackConsumerRationality2013].

(will be expanded and/or replaced)

[^1]: Given any two goods X and Y, either X is preferred to Y, Y is preferred to X, or X and Y are preferred equally [@blackConsumerRationality2013].

[^2]: Consumers are indifferent between two identical instances of the same good [@blackConsumerRationality2013].

[^3]: If a consumer prefers X to Y, and prefers Y to Z, then they must prefer X to Z [@blackConsumerRationality2013].

## Addiction and Rationality

Health economists study addiction using three types of models. Imperfectly rational models of addiction give consumers two incompatible yet internally consistent utility functions. For example, a consumer might have both a farsighted utility function used for making long-term decisions such as buying a house and a short-term utility function for making marginal decisions such as choosing to use heroin to stave off withdrawal [@culyerDictionaryHealthEconomics2005]. This model does a good job of explaining how heroin addicts living on the street can simultaneously express impressive plans for the future while injecting leftover drops of heroin from a dirty cotton using a used needle [@bourgoisRighteousDopefiend2009]. Myopic irrational models have addicts’ utility functions be exclusively shortsighted by using some combination of heavy discounting of future consequences and future consequences being unknown. For example, an addict may not care about long-term health consequences, and even if they do no individual substance user knows what consequences they will face in the future. Finally, there are theories of rational addiction, as exemplified by Becker and Murphy’s work [@culyerDictionaryHealthEconomics2005].

## A Theory of Rational Addiction

While “addictions would seem to be the antithesis of rational behavior”,  Becker and Murphy’s *A Theory of Rational Addiction* attempts to bridge the gap between homo economus and homo sapiens [-@beckerTheoryRationalAddiction1988]. According to the authors, "a good is potentially addictive if increases in past consumption raise current consumption" [@beckerTheoryRationalAddiction1988, 675]. This property is referred to as adjacent complementarity. The level of adjacent complementarity of a good determines the addictiveness of that good [@beckerTheoryRationalAddiction1988]. Given that opioid dependence has been known to occur after only a week of continuous use, and that opioid cravings are so extreme that long-term addicts are unable to "appreciate the intensity of craving when they are not currently experiencing it", opioids are extremely addictive under this definition [@meierPainKillerEmpire2018; @badgerAlteredStatesImpact2007, 685]. This is supported by the medical literature, which finds that heroin is significantly more addictive than any other substance [@nuttDevelopmentRationalScale2007].

Harmful addictions usually feature tolerance and reinforcement. Tolerance means that current consumption is less satisfying when past consumption is greater, while reinforcement means that greater current consumption increases future consumption [@beckerTheoryRationalAddiction1988]. Opioid tolerance makes any given level of consumption less satisfying because it decreases the duration and intensity of euphoria, sedation, and analgesia that opioids induce, which encourages users to increase their consumption over time [@collettOpioidToleranceClinical1998; @morganAnalysisOpioidEfficacy2011]. From a clinical perspective, opioid tolerance occurs through three mechanisms: changes in the body’s metabolism of the drug, changes in the body’s receptors for a drug, and changes in the brain’s response to the stimulus from the drug [@collettOpioidToleranceClinical1998]. The most famous reinforcement mechanism for opioids is withdrawal. Withdrawal is a common term for the symptoms that chronic opioid users feel when they discontinue use [@collettOpioidToleranceClinical1998; @morganAnalysisOpioidEfficacy2011]. These symptoms are deeply unpleasant, and the "fear of withdrawal has been considered to be one of the major forces behind persistent drug abuse in addicts" [@collettOpioidToleranceClinical1998, 62].

# History of the Opioid Epidemic

## What are Opioids?

Opioids are a group of powerful analgesic drugs [@kastinHandbookBiologicallyActive2013]. They both alleviate pain and create intense euphoria, and are considered highly addictive [@macyDopesickDealersDoctors2018; @quinonesDreamlandTrueTale2016]. Opioids generate this effects via activating opioid receptors [@kastinHandbookBiologicallyActive2013]. Opium--the original opioid--is processed liquid from opium poppies, and has been used for pleasure, pain alleviation, and controlling dysentry for thousands of years. In the early 1800s, opium was first purified into morphine, which was later transformed into heroin in the 1870s. More opium derivatives, as well as fully synthetic opioids, were developed in the 1900s. Today, the family of opioids includes heroin, morphine, fentanyl, oxycodone, hydrocodone, buprenorphine, and methadone. Unfortunately, these new stronger opioids increased the risk of overdose, which is when a high dose of opioids causes respiratory failure among other things. While opioids are highly addictive and considered dangerous, they remain uniquely effective at treating severe pain [@brummettManagingPainEssentials2013; @rastegarAmericanSocietyAddiction2015].

## America's First Opioid Epidemic

Opium and its derivatives have been consumed in the United States since the nations founding [@trickeyStoryAmerica19thCentury2018]. During the American Civil War, injured soldiers were given morphine to treat their pain [@arabloueiHistoryOpioidsAmerica2019]. At the time, morphine was relatively new, and was considered almost a miraculous panacea. While some physicians noticed and warned others about the dangers of morphine as early as the late 1860s, it was prescribed heavily by doctors until approximately 1900 due to demand from patients and inadequate medical education [@arabloueiHistoryOpioidsAmerica2019; @trickeyStoryAmerica19thCentury2018]. By 1895, approximately 0.5% of Americans were addicted to morphine and other opioids, with addiction being more prevalent among middle and upper class whites, especially white women [@trickeyStoryAmerica19thCentury2018; @whiteSlayingDragonHistory1998]1. Eventually, a combination of medical education, changing social norms, and regulation convinced doctors to cut back their opioid prescriptions, ending the epidemic[@ciccaroneFentanylUSHeroin2017; @quinonesDreamlandTrueTale2016; @trickeyStoryAmerica19thCentury2018]. Afterwards, opioid usage became associated with poor people of color--specifically opium with Chinese immigrants and heroin with African Americans--setting the stage for the demonization of opioids that lasted until quite recently [@trickeyStoryAmerica19thCentury2018].

There are many similarities between the current opioid epidemic and the one that ended 120 years ago. Both epidemics were driven by iatrogenic addiction, meaning that users first started with opioids that were legitimately prescribed to them by a physician [@meierPainKillerEmpire2018; @mustoIatrogenicAddictionProblem1985; @quinonesDreamlandTrueTale2016; @trickeyStoryAmerica19thCentury2018]. Both epidemics primarily affected wealthier white Americans [@quinonesDreamlandTrueTale2016; @trickeyStoryAmerica19thCentury2018]. In both cases, doctors were incentivized to acquiesce to demands for opioids from wealthier patients, despite evidence suggesting that it was not a proper or safe treatment [@meierPainKillerEmpire2018; @trickeyStoryAmerica19thCentury2018]. Both epidemics were worsened by new supposedly non-addictive opioids--morphine and heroin in the 19th century and OxyContin in the 21st [@ciccaroneFentanylUSHeroin2017; @quinonesDreamlandTrueTale2016; @trickeyStoryAmerica19thCentury2018]. Finally, in both epidemics addiction was treated as a medical issue, which is in sharp contrast to how opioid addiction was treated during the era in which it primarily affected impoverished people of color [@trickeyStoryAmerica19thCentury2018].

## Changes in Pain Treatment

The current opioid epidemic was ushered in by changing physician attitudes towards pain alleviation. After the first American opioid epidemic, physicians had an extremely negative outlook on opioids. They were rarely prescribed, even to terminally ill patients in hospital [@quinonesDreamlandTrueTale2016]. During this time period, chronic pain was considered out of scope for most physicians. Patients went to specialized multidisciplinary pain centers, where they received a variety of non-opioid treatments before opioids were even considered. If doctors elected to prescribe opioids, they used low strength pills that were combined with less addictive painkillers, such as acetaminophen, which made them difficult to abuse. By the 1980s, the last physicians who had dealt with widespread iatrogrenic addiction had died off, and stigma towards opioids began to fade [@meierPainKillerEmpire2018; @quinonesDreamlandTrueTale2016].

The change in physicians' attitudes towards opioids was accelerated by several factors. Insurance companies seeking to cut costs reduced payments to or stopped reimbursing entirely providers of multidisciplinary pain care due to its relatively high sticker price compared to medication-based treatment. More generally, insurance companies pressured doctors to spend less time with patients, and there is no better way to quickly end a visit than breaking out a prescription pad [@meierPainKillerEmpire2018; @quinonesDreamlandTrueTale2016; @vanzeePromotionMarketingOxyContin2009]. Simultaneously, hospitals began prioritizing patient satisfaction, creating an incentive structure that rewarded handing out opioid prescriptions to anyone who demanded them, including suspected addicts [@quinonesDreamlandTrueTale2016]. Finally, the introduction and marketing of OxyContin further quelled fears of iatrogenic addiction and made opioids prescriptions seem as routine as antibiotics or statins [@meierPainKillerEmpire2018; @quinonesDreamlandTrueTale2016; @vanzeePromotionMarketingOxyContin2009]. By 1995, physician attitudes toward pain had shifted so much that pain became the fifth vital sign, leading to changes in treatment guidelines that encouraged opioid prescriptions for non-cancer chronic pain [@alpertSupplySideDrugPolicy2017; @meierPainKillerEmpire2018; @quinonesDreamlandTrueTale2016].

## The Introduction of OxyContin

OxyContin is a prescription opioid painkiller brought to market by Purdue Pharmaceuticals in 1996 [@alpertSupplySideDrugPolicy2017; @meierPainKillerEmpire2018; @quinonesDreamlandTrueTale2016]. It is made from oxycodone, a derivative of opium, and can rival morphine in strength [@meierPainKillerEmpire2018; @quinonesDreamlandTrueTale2016]. OxyContin was unlike previous prescription painkillers in several aspects. In contrast to previous medications such as Vicodin, OxyContin was not blended with additional substances such as acetaminophen, which made it much easier to snort and inject. Furthermore, it was available in up to 160 milligram doses, whereas previous painkillers were capped at five to ten milligrams [@quinonesDreamlandTrueTale2016]. Finally, OxyContin featured a time-delay release mechanism, which the FDA allowed Purdue to market as an abuse deterrent, leading to the perception that OxyContin was non-addictive despite a complete lack of clinical studies demonstrating that this was the case [@alpertSupplySideDrugPolicy2017; @eschHowOneSentence2017; @meierPainKillerEmpire2018; @quinonesDreamlandTrueTale2016; @vanzeePromotionMarketingOxyContin2009].

More specifically, OxyContin's original label stated "Delayed absorption as provided by OxyContin tablets, is believed to reduce the abuse liability of a drug" [@eschHowOneSentence2017; @quinonesDreamlandTrueTale2016, 27]. In addition to encouraging more prescriptions from physicians, this label quelled the concerns of pharmacists seeing a huge uptake in opioid prescriptions in the late 1990s. Furthermore, Purdue Pharmaceuticals sponsored continuing medical education for physicians that minimized the risk of opioid addiction. The seminars lauded a supposed study by Porter and Jick, claiming that it demonstrated that less than one percent of patients could become addicted to opioids[^4]. In reality, the "study" was a brief letter that simply provided summary statistics on opioid use from a database that only covered inpatient care, but the gambit was effective at encouraging wanton prescribing of OxyContin [@haneyDoctorWhoWrote; @meierPainKillerEmpire2018; @porterAddictionRarePatients1980; @quinonesDreamlandTrueTale2016; @vanzeePromotionMarketingOxyContin2009; @zhangOneParagraphLetter19802017]. By the turn of the century, however, some activists, physicians, and pharmacists had noticed a major rise in opioid addictions in their communities, and began to warn others [@meierPainKillerEmpire2018].

[^4]: In reality, the only thing that Porter and Jick's letter demonstrated was that opioid dependence can occur after a brief period of use even when used exclusively under medical supervision while in hospital.

```{r appalachia_map}
"[map of Appalachia goes here"
```

Warning signs of the current opioid crisis first arose in Appalachia, where physicians such as Dr. Art Van Zee observed a huge rise in opioid addictions following the introduction of OxyContin [@meierPainKillerEmpire2018; @vanzeePromotionMarketingOxyContin2009; @quinonesDreamlandTrueTale2016]. Communities that had previously only faced alcoholism suddenly had large number of opioid addicts, who were usually much younger--high schools in inpatient rehabilitation was not unheard of. Anecdotally, Dr. Art Van Zee noticed addicts seeking OxyContin by name within one month of it arriving in local pharmacies [@meierPainKillerEmpire2018]. Addicts weren’t the only ones to notice the Purdue’s blockbuster drug—it was the first drug the DEA targeted for monitoring by brand name [@alpertSupplySideDrugPolicy2017]. By the early 2000s, there was an organized coalition based in Appalachia seeking to reformulate or recall OxyContin. The movement failed, however, due to clever legal and political maneuvering by Purdue [@meierPainKillerEmpire2018].

```{r opioid_prescription_timeseries}
"[timeseries graph of opioid overdoses goes here"
```

Despite the warnings, opioid prescriptions continued to rise throughout the 2000s and early 2010s [@macyDopesickDealersDoctors2018; @meierPainKillerEmpire2018; @quinonesDreamlandTrueTale2016]. In total, there was a 356% increase in prescriptions from 1999 to 2015 [@kruegerWhereHaveAll2017]. In fact, some communities received more prescription painkillers than there were people who could use them, which highlights the high level of diversion of prescription opioids for non-medical use during this period [@alpertSupplySideDrugPolicy2017; @quinonesDreamlandTrueTale2016]. While many doctors treated OxyContin and similar prescription painkillers as routine pharmaceuticals, their impact on patients was more similar to heroin than statins. Approximately one in every 550 patients started on opioid therapy dies from an opioid-related cause, with most deaths occurring within three years of the initial prescription [@friedenReducingRisksRelief2016; @kruegerWhereHaveAll2017]. Furthermore, prescription painkillers often lead to heroin use; approximately 75% of heroin users first misused prescription opioids [@odonnellTrendsDeathsInvolving2017]. OxyContin's devastation would continue unrestrained until its reformulation in the early 2010s [@quinonesDreamlandTrueTale2016].

## OxyContin Reformulation

In 2010, OxyContin was reformulated. The reformulation made it difficult to grind up and snort or inject, which made it less useful for recreational use [@alpertSupplySideDrugPolicy2017; @macyDopesickDealersDoctors2018; @quinonesDreamlandTrueTale2016]. Medical studies find that the formulation decreased recreational Oxycontin abuse between 30 and 50 percent, and decreased overdoses by up to two-thirds [@ciceroEffectAbuseDeterrentFormulation2012; @coplanEffectAbusedeterrentOpioid2016]. This led to the first decrease in prescription opioid and overdose deaths since 1990. Unfortunately, this decrease coincided with an unprecedented rise in heroin overdoses and deaths [@alpertSupplySideDrugPolicy2017].

## The Introduction of Black Tar Heroin

Prior to the 1980s, the US heroin market was dominated by white powder heroin trafficked from Asia into the US through New York City. This heroin was heavily adulterated, expensive, and almost exclusively available in impoverished neighborhoods of major metropolitan areas in the Northeast. In the early 1980s, however, black tar heroin started to trickle into Los Angeles from the Mexican state of Nayarit. The "Xalisco Boys"--young men from the town of Xalisco in Nayarit--would migrate to the US with a small quantity of heroin, sell it, and return home. Unlike traditional heroin markets, which operated out of abandoned buildings in major cities, the Xalisco Boys delivered heroin to suburban buyers after arranging purchases through a network of pagers and phones. This led to a demographic shift in heroin consumption, which had been predominantly consumed by poor urban blacks, towards middle and upper class whites. Further differentiating them from traditional heroin distributors, the Xalisco Boys eschewed violence and operated in small, independent cells, which minimized police attention and kept them off the radar for almost two decades. By the 1990s, the Xalisco Boys began to expand to small and medium sized cities without a preexisting heroin market across the United States [@quinonesDreamlandTrueTale2016].

By the 2000s, relatively large heroin markets supplied exclusively with Nayarit black tar existed in cities such as Portland, Columbus, Salt Lake City, Charleston, and Denver, where there had previously been almost no demand. While police in each individual city were aware of the markets, they were not considered a priority, and were not aggressively targeted by the DEA until after the spike in heroin overdose deaths [@quinonesDreamlandTrueTale2016]. While it is difficult to accurately quantify the size of black markets, it is safe to say that heroin sales exploded after the reformulation of OxyContin and the increase in monitoring and regulation of opioid prescriptions [@alpertSupplySideDrugPolicy2017; @macyDopesickDealersDoctors2018; @quinonesDreamlandTrueTale2016].

## Regulatory Changes

In response to the opioid epidemic, some states enacted regulations to attempt to reduce the supply of prescription opioids on the gray and black market. For example, states such as Ohio and Kentucky instituted prescription monitoring programs. These programs identified doctor shoppers[^5] as well as physicians prescribing opioids and other medications of concern in very high quantities or to an abnormally high percentage of their patients. Furthermore, some states began targeting pill mills[^6] [@macyDopesickDealersDoctors2018; @popoviciEffectStateLaws2018; @quinonesDreamlandTrueTale2016]. These laws were effective at reducing opioid overdose deaths--both from prescription opioids and heroin--by approximately 2000 a year [@popoviciEffectStateLaws2018]. Unfortunately, the benefits of these laws were limited by their state-specific scope, as some states like Florida became a haven for pill mills and other prescription diversion tactics, which created a steady supply of painkillers for the black market elsewhere [@quinonesDreamlandTrueTale2016]. Furthermore, the introduction of extremely strong--and therefore extremely dangerous--synthetic opioids into the black market opioid supply chain undid these efforts by more than an order of magnitude.

[^5]: Doctor shoppers are individuals who go to multiple doctors seeking specific highly divertable medications

[^6]: Pill mills are essentially physician-owned opioid distributors masquerading as pain management clinics. According to Quinones, dead giveaways include: high fees payable only in cash, large queues in rural areas, and open drug use around the clinic. While these clinics were often shut down, they were quickly replaced until regulations made them difficult to open at all, and the physicians operating them usually faced license suspensions at most unless they were caught working with organized criminal operations or having inappropriate relationships with doctor-shopping patients [@quinonesDreamlandTrueTale2016].

## The Introduction of Fentanyl

Synthetic opioids such as Fentanyl entered the US black market supply chain in the 2010s [@macyDopesickDealersDoctors2018; @quinonesDreamlandTrueTale2016]. These substances are much stronger than conventional opioids like heroin and OxyContin; Fentanyl is 50 to 100 times as powerful as morphine [@cdcFentanyl2019]. Drug dealers and distributors blend synthetic opioids into heroin, or press them into fake pills, because the synthetics are approximately 95% cheaper than heroin [@frankAddressingFentanylThreat2017; @hempsteadSupplySideResponseDeclining2014]. While most opioid addicts dislike the synthetic opioids, they are unable to identify its presence in their drugs without relatively expensive testing kits, which minimizes the risk to drug distributors who chose to cut their product to maximize profit [@carrollExposureFentanylcontaminatedHeroin2017; @sociasEpidemicDeathsFentanyl2017]. When synthetic opioids are introduced to a black market, overdose deaths increase [@hempsteadSupplySideResponseDeclining2014; @odonnellTrendsDeathsInvolving2017; @sociasEpidemicDeathsFentanyl2017].

The introduction of synthetic opioids such as Fentanyl into the black market increases overdose deaths for several reasons. For one, the extreme potency of synthetic opioids means that even tiny amounts of heterogeneity in the final product sold in the street can cause a fatal overdose [@ciccaroneFentanylUSHeroin2017; @hempsteadSupplySideResponseDeclining2014; @marshallEpidemiologyFentanylinvolvedDrug2017; @odonnellTrendsDeathsInvolving2017; @sociasEpidemicDeathsFentanyl2017]. Furthermore, its introduction lowers the price of street opioids, causing both greater consumption by current users and higher numbers of new users [@frankAddressingFentanylThreat2017]. In addition, non-opioid recreational drugs are sometimes contaminated with Fentanyl and other synthetic opioids, causing fatal opioid overdose in non-opioid users [@fairbairnNaloxoneHeroinPrescription2017; @frankAddressingFentanylThreat2017]. Furthermore, fentanyl overdoses can kill in as little as two minutes, whereas traditional opioids like heroin take 20 to 30 minutes, which dramatically reduces the opportunity window for bystanders and emergency medical services to provide naloxone [@fairbairnNaloxoneHeroinPrescription2017]. Finally, opioids contaminated with Fentanyl dramatically increase the risk of overdose in recreational users, increasing the pool of people liable to overdose from exclusively dependent users [@sociasEpidemicDeathsFentanyl2017].

## Naloxone

Opioid overdoses can be treated with naloxone [@rastegarAmericanSocietyAddiction2015]. Access to naloxone is key to reducing opioid overdose deaths. Community-level naloxone distribution to people who inject drugs began in Chicago in 1996, and has slowly diffused across the country since then. Large decreases in overdose deaths have been observed in cities after the introduction of naloxone; opioid overdose deaths decreased 95% in the 10 years following San Francisco's decision to supply naloxone [@fairbairnNaloxoneHeroinPrescription2017]. Given that naloxone has such a major impact on overdose deaths, access to naloxone is important to understanding the variation in opioid overdose deaths per capita across the United States.

## Medication-Assisted Treatment: The Gold Standard of Opioid Recovery

Medication-assisted treatment, or maintenance therapy, is the gold standard for treating opioid addiction. While opioids are considered dangerous substances, barring overdose, the primary medical concerns of chronic use are all related to how it is used[^7] @rastegarAmericanSocietyAddiction2015]. Since "long-term abstinence after detoxification is the exception rather than the rule", the most effective way to treat individuals with an opioid addiction is to provide them with a long-term maintenance dose of opioids to minimize cravings and withdrawal coupled with counseling services [@rastegarAmericanSocietyAddiction2015, 155]. Maintenance opioids include methadone and buprenorphine, and are much longer lasting than recreational opioids like heroin [@rastegarAmericanSocietyAddiction2015].

(cover geographic distribution / limited availability of MAT, especially in the past)

[^7]: For example, street users of heroin often suffer from abcesses from improper injections, HIV and other blood-borne diseases from sharing and reusing needles, and systemic infections. None of these conditions are directly caused by opioid use, and all are greatly exacerbated by homelessness and other poor living conditions [@bourgoisRighteousDopefiend2009; @rastegarAmericanSocietyAddiction2015].

## Economy and History of Ohio

(brief overview of why parts of Ohio would have much higher demand than other parts)

# Why

Explanations for the opioid epidemic in the United States can be broadly characterized as either supply-side or demand-side. Supply-siders claim that an increase in the supply of opioids triggered the 21st century epidemic, while demand-siders believe that social and economic factors are responsible. Supply-siders attribute the increase in the overall opioid supply--and therefore opioid deaths--to the rise of prescription painkillers like OxyContin, the simultaneous price decrease and supply increase of heroin outside of major metropolitan areas, and the introduction of synthetic opioids such as Fentanyl into the recreational opioid supply chain. In contrast, demand-siders focus on changes in pain treatment, poor economic outcomes in particular regions of the United States, and the overall phenomena of deaths of despair.

Appalachia

# References

<!--chapter:end:01-chap1.Rmd-->

---
output:
  html_document: default
  pdf_document: default
---

```{r setup_chpt2}
knitr::opts_chunk$set(echo = FALSE)
knitr::opts_chunk$set(warning = FALSE)
knitr::opts_chunk$set(message = FALSE)
library(citr)
```

```{r load_packages_and_df}
# Load the libraries and data used in this Rmd file
library(tidyverse)
library(here)
library(knitr) # for kable
library(tidycensus)
load(here("data", "df.Rda"))
```

```{r variable_ordering}
################################
# Disability Variable Ordering #
################################
base_disability_list <- c("disability_percent_under5", "disability_percent_5to17", "disability_percent_18to34", "disability_percent_35to64", "disability_percent_65to74", "disability_percent_75andup")

# adds a suffix to a string
# used for generating the male and female disability lists
add_suffix <- function(string, suffix) {
  string <- paste0(string, suffix)
  string
}

# create male, female, and unified disability variable ordering list
# and then turn them back into usable vectors
# instead of lists (to avoid the [[]] nonsense and ambiguity with tidyselect)
male_disability_ordering <- base_disability_list %>%
  map(add_suffix, "_male") %>%
  as.character()
female_disability_ordering <- base_disability_list %>%
  map(add_suffix, "_female") %>%
  as.character()
disability_ordering <- c(male_disability_ordering, female_disability_ordering)

###############################
# Education Variable Ordering #
###############################
education_ordering <- c("education_b_percent_highschool_or_less", "education_b_percent_college_or_more",
                        "education_s_percent_less_than_highschool", "education_s_percent_highschool",
                        "education_s_percent_ged", "education_s_percent_some_college", "education_s_percent_college",
                        "education_s_percent_graduate")

############################
# Master Variable Ordering #
############################
misc_variable_ordering <- c("OD_rate", "income_pc_individual", "percent_white", "percent_black", "population", "deaths")
master_variable_ordering <- c(misc_variable_ordering, education_ordering, disability_ordering)
```

```{r grab_county_geometry, echo=FALSE, message=FALSE, warning=FALSE}
base_map <- get_acs("county",
                    state = "OH",
                    table = "B02001",
                    geometry = TRUE,
                    output = "wide")
# reduce down to GEOID and geometry
base_map <- base_map %>%
  select(GEOID, geometry)
```

```{r map_theme}
theme_map <- theme_minimal() +
  theme(axis.title.x = element_blank(),
        axis.ticks.x = element_blank(),
        axis.title.y = element_blank(),
        axis.ticks.y = element_blank(),
        axis.text.x = element_blank(),
        axis.text.y = element_blank(),
        panel.grid.major = element_blank())
```

# Data

Census data is stored by table, year, geography, and survey. Each survey has a different set of tables, and surveys can differ from year to year [@UnderstandingACSBasics2020]. Surveys are only available for specific geographic regions, with broader, less frequent surveys covering a greater variety of geographies. Geographies include states, counties, census tracts, and school districts [@GeographicAreasCovered2020].

The majority of my independent variables were sourced from the census Annual Community Survey. The Annual Community Survey, or ACS, "provides a detailed portrait of the social, economic, housing, and demographic characteristics of America’s communities" [@UnderstandingACSBasics2020]. ACS data is available on a geographic hierarchy, going from census tracts to the United States as a whole. This thesis uses ACS data aggregated at the county level from the one-year survey [@GeographicAreasCovered2020]. Due to changes in the way that ACS data were collected in 2010, the dataset includes ACS data from the years 2012 to 2018. Tables are not necessarily consistent between years [@UnderstandingACSBasics2020].

The variables "DeathRateCDC" and "UrbanRural" come from CDC data. They are sourced from the "Drug Poisoning Mortality by County" dataset, which is published by the National Center for Health Statistics. The death rate is age-adjusted. The data was paired with the census and overdose data using the FIPS code, which is a GEOID [@calgaryNCHSDrugPoisoning].

## Sample Size

Unfortunately, not all counties in Ohio are included in the Annual Community Survey. Only counties with a population of 65,000 or greater are included in the one year Annual Community Survey [@GeographicAreasCovered2020]. In total, the sample includes 39 out of Ohio's 88 counties. Since the census data is censored based on county population, there is selection bias in the sample. This means that my results may be an inaccurate reflection of reality if there is correlation between a county's population and the county's fatal drug overdose rate. Given that the literature suggests that rural areas have suffered from greater increases in overdose rates, it is likely that there is correlation between county population and the overdose rate, meaning that there is likely selection bias in the dataset.

Counties excluded in the one year Annual Community Survey are available in other U.S. Census Bureau datasets. Counties with at least a population of 20,000 are included in the one year Annual Community Survey supplemental estimates, which provide a more limited version of the tables included in the broader one year Annual Community Survey. Furthermore, the ACS five year estimates include many counties excluded from the one-year estimates, and the decennial survey includes all areas [@UnderstandingACSBasics2020].

```{r included_counties_map}
df %>%
  group_by(county, GEOID) %>%
  summarize(population = mean(population)) %>%
  full_join(base_map, by = c("GEOID" = "GEOID")) %>%
  mutate(included = !is.na(population)) %>%
  ggplot(aes(geometry = geometry, fill = included)) +
  geom_sf() +
  labs(fill = "Included in Sample?",
       title = "Counties included in sample",
       x = "",
       y = "") +
  theme_map +
  scale_fill_viridis_d()
```

```{r check_if_excluded_counties_have_higher_od_rate}
# do something here
```

## Variable Summary Statistics

For the education variables, "_s_" refers to small bins (e.g. 11th grade education, 12th grade education), whereas "_b_" refers to the aggregation of multiple small bins (e.g. high school or less, college or more). The big bins are calculated by aggregating the smaller bins, and exclude individuals with some amount of college education but less than a bachelors-level degree. The original data was provided as a raw count for each education level (i.e. number of people with an 11th grade education, number of people with a 12th grade education, and so on). To convert it into percentages, I divided each raw count by the total population of the county and assumed that all individuals would be included in one--and only one--column.

Race is included as the variable "percent_black". Racial demographic data is represented this way because census demographic data that distinguishes between cacausian and latinx is significantly more challenging to work with, as the categories provided do not neatly add up the total population of the county. Since heroin was considered an urban black drug from the late 1930s until recently, "percent_black" seemed an effective enough variable for assesing the role of race in drug overdose rates [@macyDopesickDealersDoctors2018; @quinonesDreamlandTrueTale2016; @whiteSlayingDragonHistory1998].

Disability is broken into age and sex bins. These bins are kept small because in order to aggregate them, I would need each county-year pair's population broken down into age and sex bins. The type of disability was ignored, as the literature suggested that painful, physical disabilities would have the greatest impact, and the census-provided disability bins only seperated out deafness and blindness.

The majority of variables are in percentage form. These variables, excluding "OD_rate", have the term "percentage" in their name. Percentages are calculated using the raw population for that year, and are stored in the format XX.X%, rather than .XXX%. Percentage, or per capita, form is used to isolate the role of county population on the fatal drug overdose rate.

```{r summary_stats_all_variables, results="asis"}
df %>%
  select(-GEOID, -county, -year) %>%
  select(all_of(master_variable_ordering)) %>%
  summarize_all(list(min, max, mean, sd), na.rm = TRUE) %>%
  pivot_longer(everything()) %>% # turns into a 2 column df
  mutate(func = str_match(name, "_fn([1-4])")[,2]) %>% # func identifies which transformation was used
  mutate(func = case_when(func == 1 ~ "Min", # converts func into a meaninful label
                          func == 2 ~ "Max",
                          func == 3 ~ "Mean",
                          func == 4 ~ "Standard Deviation")) %>%
  mutate(name = str_remove(name, "_fn[1-4]")) %>% # strips the suffix which was turned into func
  pivot_wider(names_from = func, values_from = "value") %>% # untidies but makes easy to use
  mutate(`Variable Name` = name, # make the variable name label better
         name = NULL) %>%
  select(`Variable Name`, everything()) %>% # gets the variable name in front
  mutate(`Coefficient of Variation` = `Standard Deviation` / Mean) %>%
  kable(caption = "Summary statistics of all variables used in analysis",
        format.args = list(scientific = FALSE,
                           big.mark = ",",
                           digits = 5))
```



```{r OD_rate_distribution}
df %>%
  filter(!is.na(OD_rate)) %>% # drop the NA rows that occur because of the missing 2018 deaths data
  ggplot(aes(x = OD_rate)) +
  geom_histogram(bins = 25) +
  theme_minimal() +
  ggtitle("Distribution of Overdose Rate") +
  labs(y = "", x = "Overdose Rate (Deaths per 10,000)") +
  theme(axis.text.y = element_blank(),
        plot.title = element_text(hjust = 0.5))
```

The distribution of the fatal drug overdose rate between counties suggests that censoring may be occuring from the bottom. This is because the right-side tail is significantly longer and fatter than the left-side tail [@hareThesisMeetings2019].

```{r county_racial_distribution}
df %>%
  ggplot(aes(x = percent_black)) +
  geom_histogram(bins = 20) +
  theme_minimal() +
  ggtitle("Distribution of Percent Black") +
  labs(x = "Percent Black", y = "") +
  scale_x_continuous(labels = function(x) paste0(x, "%")) + # adds percentage signs; scales::percent assumes .XXX format, while I have XX.X
  theme(axis.text.y = element_blank(),
        plot.title = element_text(hjust = 0.5))
```

## Maps

Let's draw some maps.

```{r percent_black_maps}
df %>%
  group_by(county, GEOID) %>%
  summarize(percent_black = mean(percent_black)) %>%
  full_join(base_map, by = c("GEOID" = "GEOID")) %>%
  ggplot(aes(fill = percent_black, geometry = geometry)) +
  geom_sf() +
  theme_map +
  scale_fill_viridis_c() +
  labs(subtitle = "Grey means excluded from sample",
       title = "Percent Black by County",
       fill = "% Black")
```

The yellow county is Cuyahoga County, which contains the city of Cleveland. Before the 1990s, Cleveland was considered to be the only region in Ohio to contain a significant heroin market [@quinonesDreamlandTrueTale2016]. Therefore, we would expect Cleveland to have started off with an above average drug overdose death rate. With the rise of the Xalisco boys and the introduction of OxyContin, heroin markets spread across the state [@macyDopesickDealersDoctors2018; @quinonesDreamlandTrueTale2016]. Hence, we would expect Cleveland, and therefore Cuyahoga County, to have a higher than average overdose rate prior to the mid 90s, and for other counties to have a larger increase in their overdose death rate.

# Methods

I used the R package Tidycensus to download census data. Tidycensus was created by Kyle Walker and is maintained by a community on GitHub. Tidycensus allows "R users to return Census and ACS data as tidyverse-ready data frames, and optionally returns a list-column with feature geometry for many geographies". The "list-column with feature geometry" allows the R user to easily draw maps using the downloaded census data and a ggplot2 one-liner. Dataframes can be downloaded in either a wide or tidy format, and brief descriptions of each variable are available. The package is an API wrapper for data.census.gov, and the API calls it creates can be accessed and manually ran using packages such as rvest. The package supports both American Community Survey and Decennial data. To pull down data with Tidycensus, you need to know the variable/table name, the year, the geographic level, and the survey.

 To identify the variables and tables available from a survey, you use the command `tidycensus::load_variables(year, survey)`, where year is a year in numerical format (e.g. 2018), and survey is a survey in character format (e.g. "acs1"). To search for variables within a specific table in the survey, filter the output of `load_variables()` with `filter(stringr::str_detect(name, pattern))`, where pattern is the table name followed by an underscore. Variable names can be merged with the tidy output of another Tidycensus call by using `rename(variable = name)` to change the column names of the output of `load_variables()` to match the column names of a Tidycensus dataframe, and then using `dplyr::left_join(tidycensus_dataframe, output_of_load_variables, by = c("name" = "name"))`.
 
The geographical level, survey, and year are all easier to determine. Geographical levels are things like state, county, school district, census tract, and congressional district. They are represented as characters. Not all geographical levels are supported by Tidycensus, and not all surveys are available for all geographies. Surveys include the different American Community Surveys, the Decennial census, and supplemental estimates. They can be found on the U.S. Census's website. Finally, year is simply a valid year for that survey provided as a number.

To pull down actual data from census.data.gov using Tidycensus, you use one of three functions depending on the survey that you are working with. To work with the decennial census, use `get_decennial()`. To work with American Community Survey data, use `get_acs()`. Finally, use `get_estimates()` to work with the Census Bureau's population estimates API.

[@walkerTidycensus; @tidycensus2020]

In order to better use Tidycensus, I wrote custom functions to accomplish several repeated tasks. One function, `get_census_tables_multiple_years(table, years)`, allows the user to download multiple years of a particular census table at once. The functions accept a table code and year range, and downloads the table for each year, pivot it into a wide format, adds a year column, and binds the rows of the resulting dataframes into one master dataframe, which is returned. Another function, `clean_county_col(df)`, modifies the "county" column, removing the string "County, Ohio" from each entry in order to make it easier to join with other datasets.

Census tables were identified through several means. Using Tidycensus's "load_variables" function, I created a dataframe of all variables covered in the package and filtered it using keywords and R's grep wrapper. Keywords were selected by brainstorming off of the hypothesis that the literature put forward. For example, I used the keyword "disability" for the disability variables, "median income" and "average income" and "mean income" for income, and so on. Furthermore, Reed's data services librarian, Mahria Lebow, helped me identify relevant census tables by examining the census table shells and going through the documentation available at data.census.gov [@lebowCensusHelp]. I decided to start off with one year Annual Community Survey data because it had a relatively limited number of variables, making it easier to work with, and it provided more statistical power than relying on the decennial survey, which at best offered three rows per county (1990, 2000, 2010).

Plots, graphs, and maps that appear within this thesis were produced using ggplot2 unless otherwise noted. ggplot2 is a R package that is part of the Tidyverse universe of R packages. The package allows for a R user to quickly produce aesthetically appealing graphs and maps using any tidy dataset. Visualizations made in ggplot2 are designed using a standardized "grammar of graphics", which helps keep the visual appearance of a variety of different types of visualizations consistent [@wickhamGgplot2ElegantGraphics2016]. One major advantage of working with Tidyverse-compliant packages such as ggplot2 and Tidycensus is that they are designed to work together easily. This allows a R user to go directly from pulling down census data to making maps without having to reshape data or otherwise perform tedious data cleaning, wrangling, and preparation tasks [@walkerTidycensus2020; @wickhamGgplot2ElegantGraphics2016].

Initial regressions were performed using simple linear regression.

In addition to the simple linear regression models, a model with a censored dependent variable is also used. This model, referred to as a Tobit model, is used when there is censoring of the dependent variable [@hareThesisMeetings2019]. Censoring is when all values above or below a particular value are recorded as a single value. For example, income data where all incomes over $100,000 a year are coded as $100,000 is censored from above.


<!--chapter:end:02-chap2.Rmd-->

```{r include_packages_2, include = FALSE}
# This chunk ensures that the thesisdown package is
# installed and loaded. This thesisdown package includes
# the template files for the thesis and also two functions
# used for labeling and referencing
if(!require(devtools))
  install.packages("devtools", repos = "http://cran.rstudio.com")
if(!require(dplyr))
    install.packages("dplyr", repos = "http://cran.rstudio.com")
if(!require(ggplot2))
    install.packages("ggplot2", repos = "http://cran.rstudio.com")
if(!require(ggplot2))
    install.packages("bookdown", repos = "http://cran.rstudio.com")
if(!require(thesisdown)){
  library(devtools)
  devtools::install_github("ismayc/thesisdown")
  }
library(thesisdown)
```

```{r setup_chpt3, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
knitr::opts_chunk$set(warning = FALSE)
library(citr)
```

```{r install_packages}
library(broom)
library(tidyverse)
library(here)
library(knitr) # for kable
load(here("data", "df.Rda"))
```

# Results

```{r basic_regression_formula}
# formula used throughout chapter 3 as of right now
basic_regression_formula <- formula(OD_rate ~ income_pc_individual + percent_black + education_b_percent_highschool_or_less + education_b_percent_college_or_more + disability_percent_5to17_male + disability_percent_18to34_male + disability_percent_35to64_male + disability_percent_65to74_male + disability_percent_5to17_female + disability_percent_18to34_female + disability_percent_35to64_female + disability_percent_65to74_female)
```

## Basic Model With All Counties Included in Data
```{r basic_ols}
basic_model <- lm(basic_regression_formula, df)

glance(basic_model) %>%
  kable()

tidy(basic_model) %>%
  mutate(significant = if_else(p.value < .05, TRUE, FALSE)) %>%
  kable()
```

## Basic Model Excluding Cleveland

```{r ols_no_cle}
df_no_cle <- df %>%
  filter(county != "Cuyahoga")

basic_model_no_cle <- lm(basic_regression_formula, df_no_cle)

glance(basic_model_no_cle) %>%
  select(r.squared, adj.r.squared)

tidy(basic_model_no_cle) %>%
  mutate(significant = if_else(p.value < .05, TRUE, FALSE)) %>%
  kable()
```

## Tobit Model

For the Tobit model, I used the minimum value of OD_rate across the entire dataset as my left limit for the censored variable as instructed to by Denise. According to Denise, if tobit coefficients are very similar to simple linear regression coefficients, then censoring is not a big issue [@hareThesisMeetings2019]. In the table above, "estimate" is sourced from the original simple linear regression, while "tobit_estimate" unsurprisingly comes from the Tobit model. "percentDifferenceInEstimate" is the absolute difference between the models divided by "tobit_estimate" and converted into a percentage in the form XX.X%.

```{r tobit_functions}
tobit <- function(formula, left, data = df) {
  summary(censReg::censReg(formula, left = left, data = df, logLikOnly = FALSE))
}

# converts the output of tobit() into a tidy dataframe
tobit_to_table <- function(tobitResults) {
  tobitResults$estimate %>%
    as.data.frame() %>%
    rownames_to_column(var = "variable")
}
```

```{r tobit_all_counties}
tobit(basic_regression_formula, left = 0.5066819) %>%
  tobit_to_table() %>%
  kable()
```

```{r tobit_no_cle}
tobit(basic_regression_formula, left = 0.5066819, data = df_no_cle) %>%
  tobit_to_table() %>%
  kable()
```

```{r tobit_vs_ols}
tobit(basic_regression_formula, left = 0.5066819) %>%
  tobit_to_table() %>%
  select(tobit_estimate = Estimate, variable) %>%
  left_join(tidy(basic_model), by = c("variable" = "term")) %>%
  select(tobit_estimate, variable, ols_estimate = estimate) %>%
  mutate(percentDifferenceInEstimate = (abs(ols_estimate - tobit_estimate) / abs(tobit_estimate) * 100)) %>%
  select(variable, `OLS Estimate` = ols_estimate, `Tobit Estimate` = tobit_estimate, `Percent Difference Between Estimates` = percentDifferenceInEstimate) %>%
  kable()
```

<!--chapter:end:03-chap3.Rmd-->

# Conclusion {-}

<!--chapter:end:04-conclusion.Rmd-->

`r if(knitr:::is_latex_output()) '\\appendix'`

`r if(!knitr:::is_latex_output()) '# (APPENDIX) Appendix {-}'` 

<!--
If you feel it necessary to include an appendix, it goes here.
-->


# The First Appendix

This first appendix includes all of the R chunks of code that were hidden throughout the document (using the `include = FALSE` chunk tag) to help with readibility and/or setup.

**In the main Rmd file**

#```{r ref.label='include_packages', results='hide', echo = TRUE}
#```

**In Chapter \@ref(ref-labels):**

#```{r ref.label='include_packages_2', results='hide', echo = TRUE}
#```

# The Second Appendix, for Fun

<!--chapter:end:05-appendix.Rmd-->

<!--
The bib chunk below must go last in this document according to how R Markdown renders.  More info is at http://rmarkdown.rstudio.com/authoring_bibliographies_and_citations.html
-->

\backmatter

<!-- 
If you'd like to change the name of the bibliography to something else,
delete "References" and replace it.
-->

# References {-}
<!--
This manually sets the header for this unnumbered chapter.
-->
\markboth{References}{References}
<!--
To remove the indentation of the first entry.
-->
\noindent

<!--
To create a hanging indent and spacing between entries.  These three lines may need to be removed for styles that don't require the hanging indent.
-->

\setlength{\parindent}{-0.20in}
\setlength{\leftskip}{0.20in}
\setlength{\parskip}{8pt}


<!--
This is just for testing with more citations for the bibliography at the end.  Add other entries into the list here if you'd like them to appear in the bibliography even if they weren't explicitly cited in the document.
-->

---
nocite: | 
  @angel2000, @angel2001, @angel2002a
...

<!--chapter:end:99-references.Rmd-->

